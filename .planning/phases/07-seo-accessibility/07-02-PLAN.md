---
phase: 07-seo-accessibility
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - src/main.ts
  - src/composables/useAppAnnouncer.ts
  - src/composables/index.ts
  - src/App.vue
autonomous: true

must_haves:
  truths:
    - "Screen reader users hear announcements for dynamic content changes"
    - "VueAnnouncer is registered as Vue plugin"
    - "Composable provides typed methods for common announcements"
  artifacts:
    - path: "src/composables/useAppAnnouncer.ts"
      provides: "Application-specific announcer wrapper"
      exports: ["useAppAnnouncer"]
    - path: "src/main.ts"
      provides: "VueAnnouncer plugin registration"
      contains: "VueAnnouncer"
    - path: "src/App.vue"
      provides: "VueAnnouncer component and sr-only class"
      contains: "VueAnnouncer"
  key_links:
    - from: "src/main.ts"
      to: "@vue-a11y/announcer"
      via: "app.use()"
      pattern: "use\\(VueAnnouncer\\)"
    - from: "src/App.vue"
      to: "VueAnnouncer"
      via: "template component"
      pattern: "<VueAnnouncer"
---

<objective>
Install accessibility dependencies and set up the ARIA live region announcer infrastructure.

Purpose: Establish foundation for screen reader announcements (SEO-04). The global announcer pattern solves Vue's v-if reactivity issue where live regions must exist in DOM before content changes.

Output: Installed deps, VueAnnouncer plugin registered, useAppAnnouncer composable ready for use
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/07-seo-accessibility/07-RESEARCH.md
@.planning/phases/07-seo-accessibility/07-CONTEXT.md
@src/main.ts
@src/App.vue
@src/composables/index.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install accessibility dependencies</name>
  <files>package.json</files>
  <action>
Install the following packages:

```bash
bun add @vue-a11y/announcer@next focus-trap @vueuse/integrations
```

Note: @vue-a11y/announcer@next is the Vue 3 compatible version (3.0.0-beta.3).
focus-trap and @vueuse/integrations are for focus management in dialogs (used in Plan 03).
  </action>
  <verify>`cat package.json | grep -E "(vue-a11y|focus-trap|vueuse/integrations)"` shows all three packages</verify>
  <done>package.json contains @vue-a11y/announcer, focus-trap, and @vueuse/integrations</done>
</task>

<task type="auto">
  <name>Task 2: Register VueAnnouncer plugin and add sr-only class</name>
  <files>src/main.ts, src/App.vue</files>
  <action>
1. Update src/main.ts to register VueAnnouncer:

```typescript
import { createApp } from 'vue'

// Pinia
import { createPinia } from 'pinia';
import piniaPluginPersistedstate from 'pinia-plugin-persistedstate';

// Vuetify
import 'vuetify/styles'
import '@mdi/font/css/materialdesignicons.css'
import { createVuetify } from 'vuetify'
import * as components from 'vuetify/components'
import * as directives from 'vuetify/directives'

// Accessibility
import VueAnnouncer from '@vue-a11y/announcer'
import '@vue-a11y/announcer/dist/style.css'

import App from './App.vue'
import { graphqlClient } from '@/api'

// Pinia setup
const pinia = createPinia();
pinia.use(piniaPluginPersistedstate);

// Vuetify setup (existing config unchanged)
const vuetify = createVuetify({
  components,
  directives,
  theme: {
    defaultTheme: 'light',
    themes: {
      light: {
        dark: false,
        colors: {
          primary: '#a09588',
          secondary: '#424242',
          surface: '#FFFFFF',
          background: '#FAFAFA',
        }
      },
      dark: {
        dark: true,
        colors: {
          primary: '#BDBDBD',
          secondary: '#757575',
        }
      }
    }
  }
})

const app = createApp(App)
app.use(VueAnnouncer)  // Must be before pinia for route announcements (if router added later)
app.use(pinia)
app.use(vuetify)
app.use(graphqlClient)
app.mount('#app')
```

2. Update src/App.vue to add VueAnnouncer component and sr-only class:

In template, add VueAnnouncer inside v-app:
```vue
<template>
  <v-app>
    <VueAnnouncer class="sr-only" />
    <AppBar @openSettings="showSettings = true" />
    <!-- rest unchanged -->
  </v-app>
</template>
```

Add sr-only style in a scoped style block:
```vue
<style scoped>
.sr-only {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0, 0, 0, 0);
  white-space: nowrap;
  border: 0;
}
</style>
```
  </action>
  <verify>`bun run typecheck` passes, `bun run dev` starts without console errors</verify>
  <done>VueAnnouncer registered in main.ts and rendered in App.vue with sr-only styling</done>
</task>

<task type="auto">
  <name>Task 3: Create useAppAnnouncer composable</name>
  <files>src/composables/useAppAnnouncer.ts, src/composables/index.ts</files>
  <action>
1. Create src/composables/useAppAnnouncer.ts:

```typescript
import { useAnnouncer } from '@vue-a11y/announcer'

/**
 * Application-specific announcer wrapper.
 * Provides typed methods for common announcement patterns.
 *
 * Uses polite for non-urgent updates (calculation results, loading states).
 * Uses assertive for urgent messages (errors).
 */
export function useAppAnnouncer() {
  const { polite, assertive } = useAnnouncer()

  /**
   * Announce calculation results to screen readers.
   * Example: "Carrier frequency calculated: 1 in 25 for European population"
   */
  function announceCalculation(ratio: string, population: string) {
    polite(`Carrier frequency calculated: ${ratio} for ${population} population`)
  }

  /**
   * Announce error messages immediately.
   * Example: "Error: Gene BRCA1 not found in gnomAD"
   */
  function announceError(message: string) {
    assertive(`Error: ${message}`)
  }

  /**
   * Announce loading state changes.
   * @param what - What is loading (e.g., "gene data", "variant data")
   * @param done - If true, announces completion instead of start
   */
  function announceLoading(what: string, done = false) {
    polite(done ? `${what} loaded` : `Loading ${what}...`)
  }

  /**
   * Announce wizard step changes.
   * Example: "Step 2: Select Population"
   */
  function announceStep(stepNumber: number, stepName: string) {
    polite(`Step ${stepNumber}: ${stepName}`)
  }

  /**
   * Announce gene selection.
   * Example: "Selected gene: CFTR"
   */
  function announceGeneSelection(geneSymbol: string) {
    polite(`Selected gene: ${geneSymbol}`)
  }

  return {
    polite,
    assertive,
    announceCalculation,
    announceError,
    announceLoading,
    announceStep,
    announceGeneSelection,
  }
}

export type UseAppAnnouncerReturn = ReturnType<typeof useAppAnnouncer>
```

2. Update src/composables/index.ts to export the new composable:

Add these lines:
```typescript
export { useAppAnnouncer } from './useAppAnnouncer';
export type { UseAppAnnouncerReturn } from './useAppAnnouncer';
```
  </action>
  <verify>`bun run typecheck` passes, composable can be imported in a test file</verify>
  <done>useAppAnnouncer composable created and exported</done>
</task>

</tasks>

<verification>
1. `bun run typecheck` passes with no errors
2. `bun run dev` starts without console errors
3. `grep -r "VueAnnouncer" src/` shows main.ts and App.vue references
4. `grep -r "useAppAnnouncer" src/composables/` shows composable and export
</verification>

<success_criteria>
- All accessibility packages installed (check package.json)
- VueAnnouncer plugin registered in main.ts before other plugins
- VueAnnouncer component rendered in App.vue with sr-only class
- useAppAnnouncer composable provides typed methods for announcements
- Application builds and runs without errors
</success_criteria>

<output>
After completion, create `.planning/phases/07-seo-accessibility/07-02-SUMMARY.md`
</output>
