---
phase: 17-screenshot-automation
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/DisclaimerBanner.vue
  - src/components/wizard/WizardStepper.vue
  - src/components/wizard/StepGene.vue
  - src/components/wizard/StepStatus.vue
  - src/components/wizard/StepFrequency.vue
  - src/components/wizard/StepResults.vue
  - src/components/wizard/TextOutput.vue
  - src/components/GeneSearch.vue
  - src/components/GeneConstraintCard.vue
  - src/components/ClingenWarning.vue
  - src/components/FrequencyResults.vue
  - src/components/FilterChips.vue
  - src/components/VariantTable.vue
  - src/components/VariantModal.vue
  - src/components/SettingsDialog.vue
  - src/components/HistoryPanel.vue
  - src/components/HistoryDrawer.vue
  - src/components/AppFooter.vue
autonomous: true

must_haves:
  truths:
    - "Key UI elements have data-testid attributes for reliable Playwright targeting"
    - "data-testid attributes follow a consistent kebab-case naming convention"
    - "The app builds successfully with no TypeScript or lint errors after adding attributes"
    - "Existing functionality is unaffected by the attribute additions"
  artifacts:
    - path: "src/components/DisclaimerBanner.vue"
      provides: "data-testid on disclaimer dialog and accept button"
      contains: "data-testid"
    - path: "src/components/wizard/WizardStepper.vue"
      provides: "data-testid on stepper component and step items"
      contains: "data-testid"
    - path: "src/components/GeneSearch.vue"
      provides: "data-testid on gene search autocomplete"
      contains: "data-testid"
    - path: "src/components/SettingsDialog.vue"
      provides: "data-testid on settings dialog"
      contains: "data-testid"
    - path: "src/components/HistoryPanel.vue"
      provides: "data-testid on history panel"
      contains: "data-testid"
  key_links:
    - from: "scripts/generate-screenshots.ts"
      to: "src/components/**/*.vue"
      via: "Playwright locator('[data-testid=\"...\"]')"
      pattern: "data-testid"
---

<objective>
Add data-testid attributes to all Vue components that the screenshot script needs to target for navigation, interaction, and state verification. These attributes decouple the screenshot script from Vuetify CSS class names and DOM structure, making captures resilient to UI refactoring.

Purpose: SHOT-16 requires data-testid attributes on key UI elements. Without them, the screenshot script would use fragile CSS selectors that break on Vuetify version updates.
Output: All targeted components have data-testid attributes. App builds and runs identically.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-screenshot-automation/17-CONTEXT.md

Key references for what elements need targeting:
@.planning/phases/17-screenshot-automation/17-RESEARCH.md (Pattern 3: data-testid attributes)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add data-testid attributes to wizard and core components</name>
  <files>
    src/components/DisclaimerBanner.vue
    src/components/wizard/WizardStepper.vue
    src/components/wizard/StepGene.vue
    src/components/wizard/StepStatus.vue
    src/components/wizard/StepFrequency.vue
    src/components/wizard/StepResults.vue
    src/components/wizard/TextOutput.vue
    src/components/GeneSearch.vue
    src/components/GeneConstraintCard.vue
    src/components/ClingenWarning.vue
    src/components/FrequencyResults.vue
  </files>
  <action>
    Add `data-testid` attributes to the following elements. Use kebab-case names prefixed by component context. Only add to the template section -- no script/style changes needed.

    **DisclaimerBanner.vue:**
    - `v-dialog` root: `data-testid="disclaimer-dialog"`
    - "I Understand" button: `data-testid="disclaimer-accept-btn"`

    **WizardStepper.vue:**
    - `v-stepper` root: `data-testid="wizard-stepper"`
    - `v-stepper-item` for step 1: `data-testid="wizard-step-1"`
    - `v-stepper-item` for step 2: `data-testid="wizard-step-2"`
    - `v-stepper-item` for step 3: `data-testid="wizard-step-3"`
    - `v-stepper-item` for step 4: `data-testid="wizard-step-4"`
    - `v-stepper-window` (the content area): `data-testid="wizard-content"`

    **StepGene.vue:**
    - Root container: `data-testid="step-gene"`
    - The "Next" or continue button (look for the button that triggers @complete): `data-testid="step-gene-next-btn"`

    **GeneSearch.vue:**
    - `v-autocomplete`: `data-testid="gene-search-input"`

    **GeneConstraintCard.vue:**
    - Root card element: `data-testid="gene-constraint-card"`

    **ClingenWarning.vue:**
    - Root element (the alert/warning): `data-testid="clingen-warning"`

    **StepStatus.vue:**
    - Root container: `data-testid="step-status"`
    - Look for the radio group or selection list for patient status options. Add `data-testid="status-option-heterozygous"` (or equivalent) to the "Heterozygous carrier" option. Check the component structure to find how options are rendered — likely a v-radio-group or v-list with click handlers. Add testid to the specific option element for "heterozygous".
    - Next/continue button: `data-testid="step-status-next-btn"`

    **StepFrequency.vue:**
    - Root container: `data-testid="step-frequency"`
    - The gnomAD tab (look for tabs showing frequency sources): `data-testid="freq-tab-gnomad"`
    - Next/continue button: `data-testid="step-frequency-next-btn"`

    **StepResults.vue:**
    - Root container: `data-testid="step-results"`
    - The results summary card (the card showing gene name + carrier frequency): `data-testid="results-summary-card"`
    - The population table (v-data-table or equivalent): `data-testid="population-table"`

    **TextOutput.vue:**
    - Root container: `data-testid="text-output"`
    - The section chips area (where toggleable section chips are displayed): `data-testid="text-section-chips"`
    - The text content area (where clinical text is rendered): `data-testid="text-content"`

    **FrequencyResults.vue:**
    - Root container: `data-testid="frequency-results"`

    IMPORTANT:
    - Read each component file first to understand the exact template structure before adding attributes
    - Place data-testid on the outermost relevant element
    - For Vuetify components (v-dialog, v-stepper, etc.), data-testid goes directly on the component tag
    - Do NOT change any logic, styles, or props — only add data-testid attributes
    - Ensure proper formatting: `data-testid="name"` as a separate attribute on its own line following the project's Vue formatting style
  </action>
  <verify>
    - `npm run build` succeeds with no errors
    - `npm run lint` passes (or only has pre-existing warnings)
    - `grep -r 'data-testid' src/components/ | wc -l` shows at least 20 instances
  </verify>
  <done>
    All wizard flow components and core display components have data-testid attributes. Build passes. No functional changes.
  </done>
</task>

<task type="auto">
  <name>Task 2: Add data-testid attributes to feature components</name>
  <files>
    src/components/FilterChips.vue
    src/components/VariantTable.vue
    src/components/VariantModal.vue
    src/components/SettingsDialog.vue
    src/components/HistoryPanel.vue
    src/components/HistoryDrawer.vue
    src/components/AppFooter.vue
  </files>
  <action>
    Add `data-testid` attributes to these feature components that are targeted by non-wizard screenshots.

    **FilterChips.vue:**
    - Root container: `data-testid="filter-chips"`
    - Individual filter chip toggles (if identifiable): add testid with filter name, e.g., `data-testid="filter-chip-lof"`, `data-testid="filter-chip-clinvar"`, `data-testid="filter-chip-missense"`

    **VariantTable.vue:**
    - Root container: `data-testid="variant-table"`

    **VariantModal.vue:**
    - The dialog/modal: `data-testid="variant-modal"`
    - Close button: `data-testid="variant-modal-close-btn"`

    **SettingsDialog.vue:**
    - `v-dialog` root: `data-testid="settings-dialog"`
    - General tab: `data-testid="settings-tab-general"`
    - Filters tab: `data-testid="settings-tab-filters"`
    - Templates tab: `data-testid="settings-tab-templates"`

    **HistoryPanel.vue:**
    - Root container (`.history-panel` div): `data-testid="history-panel"`
    - First history entry (if possible, add to the v-list-item rendering): consider adding `data-testid="history-entry"` to each entry's v-list-item

    **HistoryDrawer.vue:**
    - The drawer/panel wrapper: `data-testid="history-drawer"`

    **AppFooter.vue:**
    - The settings button (the icon button that opens SettingsDialog): `data-testid="footer-settings-btn"`
    - The history button (if there's a button that opens history): `data-testid="footer-history-btn"`
    - Look for the footer container: `data-testid="app-footer"`

    Read each file first to understand its template structure. Some components may be structured differently than expected (e.g., FilterChips might render chips in a v-for loop — add testid via dynamic binding `:data-testid="'filter-chip-' + chip.key"` or similar).

    IMPORTANT:
    - Only add data-testid attributes to template elements
    - Do NOT change any logic, styles, or props
    - For AppFooter.vue, carefully identify which icon buttons correspond to settings and history (check for @click handlers that emit events or toggle state)
  </action>
  <verify>
    - `npm run build` succeeds with no errors
    - `npm run lint` passes
    - `grep -r 'data-testid' src/components/ | wc -l` shows at least 30 instances total
    - `npm run dev` starts the app successfully (quick manual check that nothing is broken)
  </verify>
  <done>
    All feature components targeted by screenshots have data-testid attributes. App builds and lints cleanly. SHOT-16 is fully satisfied.
  </done>
</task>

</tasks>

<verification>
- `npm run build` passes (TypeScript check + Vite build)
- `npm run lint` passes
- At least 30 data-testid attributes across all modified components
- No functional regression: app loads and wizard flow works
</verification>

<success_criteria>
- SHOT-16 fully satisfied: key UI elements have data-testid attributes
- Consistent naming: all testids use kebab-case
- Zero functional changes to the application
- Build and lint pass cleanly
</success_criteria>

<output>
After completion, create `.planning/phases/17-screenshot-automation/17-02-SUMMARY.md`
</output>
