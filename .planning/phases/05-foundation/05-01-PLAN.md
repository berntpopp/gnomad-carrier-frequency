---
phase: 05-foundation
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - vite.config.ts
  - src/vite-env.d.ts
  - src/main.ts
  - src/composables/useTheme.ts
autonomous: true
user_setup: []

must_haves:
  truths:
    - "App can switch between light and dark themes programmatically"
    - "Theme preference persists across page refresh"
    - "App version is accessible at runtime"
  artifacts:
    - path: "src/composables/useTheme.ts"
      provides: "Theme toggle composable with VueUse + Vuetify sync"
      exports: ["useAppTheme"]
    - path: "src/main.ts"
      provides: "Vuetify configuration with both light and dark themes"
      contains: "dark:"
    - path: "vite.config.ts"
      provides: "Version injection via define option"
      contains: "VITE_APP_VERSION"
  key_links:
    - from: "src/composables/useTheme.ts"
      to: "vuetify theme"
      via: "useTheme().global.name.value"
      pattern: "vuetifyTheme\\.global\\.name\\.value"
    - from: "src/composables/useTheme.ts"
      to: "localStorage"
      via: "useDark persistence"
      pattern: "useDark"
---

<objective>
Create theme and version infrastructure for the Foundation phase.

Purpose: Establish the foundational infrastructure that enables theme switching with persistence and runtime version access. This is pure infrastructure - no visible UI changes yet.

Output: Theme composable (useTheme.ts), Vuetify dark theme config, version injection via Vite define, updated package.json version
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-foundation/05-CONTEXT.md
@.planning/phases/05-foundation/05-RESEARCH.md

@src/main.ts
@src/vite-env.d.ts
@vite.config.ts
@package.json
</context>

<tasks>

<task type="auto">
  <name>Task 1: Version infrastructure</name>
  <files>
    - package.json
    - vite.config.ts
    - src/vite-env.d.ts
  </files>
  <action>
    1. Update package.json version from "0.1.0" to "1.1.0" (semver for v1.1 release)

    2. Update vite.config.ts to inject version at build time:
       - Import package.json: `import pkg from './package.json'`
       - Add define option: `define: { 'import.meta.env.VITE_APP_VERSION': JSON.stringify(pkg.version) }`

    3. Update src/vite-env.d.ts to add type definition:
       - Add interface extending ImportMetaEnv with `readonly VITE_APP_VERSION: string`
  </action>
  <verify>
    Run `bun run typecheck` - should pass with no errors related to VITE_APP_VERSION type
  </verify>
  <done>
    - package.json version is "1.1.0"
    - vite.config.ts has define option injecting VITE_APP_VERSION
    - vite-env.d.ts has VITE_APP_VERSION type definition
    - TypeScript recognizes import.meta.env.VITE_APP_VERSION as string
  </done>
</task>

<task type="auto">
  <name>Task 2: Theme composable and Vuetify dark theme</name>
  <files>
    - src/main.ts
    - src/composables/useTheme.ts
    - src/composables/index.ts
  </files>
  <action>
    1. Update src/main.ts Vuetify configuration to include dark theme:
       - Add dark theme object alongside existing light theme
       - Keep defaultTheme as 'light' (VueUse will override on mount based on localStorage/system preference)
       - Dark theme colors: primary: '#2196F3', secondary: '#616161'

    2. Create src/composables/useTheme.ts:
       - Import useDark, useToggle from @vueuse/core
       - Import useTheme from vuetify
       - Import watch, computed from vue
       - Create useAppTheme() composable that:
         a. Gets Vuetify theme via useTheme()
         b. Creates isDark ref via useDark({ storageKey: 'carrier-freq-theme' })
         c. Creates toggleTheme via useToggle(isDark)
         d. Watches isDark and syncs to vuetifyTheme.global.name.value ('dark' or 'light')
         e. Returns: isDark, toggleTheme, tooltipText (computed), themeIcon (computed)
       - tooltipText: 'Switch to light mode' when dark, 'Switch to dark mode' when light
       - themeIcon: 'mdi-weather-sunny' when dark (click to go light), 'mdi-weather-night' when light (click to go dark)

    3. Export useAppTheme from src/composables/index.ts
  </action>
  <verify>
    Run `bun run typecheck` - should pass with no errors
    Run `bun run lint` - should pass
  </verify>
  <done>
    - Vuetify has both light and dark themes configured
    - useAppTheme composable exists and exports isDark, toggleTheme, tooltipText, themeIcon
    - Composable is exported from composables/index.ts
    - VueUse useDark handles system preference detection on first visit
    - Theme state persists to localStorage under 'carrier-freq-theme' key
  </done>
</task>

</tasks>

<verification>
After completing both tasks:
1. `bun run typecheck` passes
2. `bun run lint` passes
3. `bun run build` succeeds (confirms version injection works at build time)
</verification>

<success_criteria>
- package.json version is "1.1.0"
- VITE_APP_VERSION is injectable and typed
- useAppTheme composable provides theme toggle with persistence
- Vuetify has both light and dark themes configured
- All type checks and lint pass
</success_criteria>

<output>
After completion, create `.planning/phases/05-foundation/05-01-SUMMARY.md`
</output>
