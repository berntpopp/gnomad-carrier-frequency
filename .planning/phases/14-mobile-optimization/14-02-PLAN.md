---
phase: 14-mobile-optimization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - src/components/VariantTable.vue
  - src/components/wizard/StepResults.vue
autonomous: true

must_haves:
  truths:
    - "Variant table can be scrolled horizontally on mobile to see all columns"
    - "First column (checkbox) stays visible while scrolling variant table"
    - "Results population table is usable on mobile with horizontal scroll"
    - "Tables have visual scroll indicator showing more content exists"
  artifacts:
    - path: "src/components/VariantTable.vue"
      provides: "Horizontal scroll with frozen first column"
      contains: "overflow-x"
    - path: "src/components/wizard/StepResults.vue"
      provides: "Horizontal scroll wrapper for results table"
      contains: "table-scroll-wrapper"
  key_links:
    - from: "src/components/VariantTable.vue"
      to: "CSS sticky positioning"
      via: "scoped styles"
      pattern: "position:\\s*sticky"
---

<objective>
Make data tables usable on mobile with horizontal scroll and frozen columns.

Purpose: Addresses MOB-03 - Variant table and results table must be usable on small screens.
Output: Both tables wrapped in horizontal scroll containers with frozen first columns and scroll indicators.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/14-mobile-optimization/14-RESEARCH.md
@src/components/VariantTable.vue
@src/components/wizard/StepResults.vue
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add horizontal scroll with frozen columns to VariantTable</name>
  <files>src/components/VariantTable.vue</files>
  <action>
    Wrap the v-data-table in a scrollable container with frozen first column:

    1. Keep the search field outside the scroll wrapper (it should stay fixed)
    2. Wrap only the v-data-table in a div with class "table-scroll-wrapper"
    3. Add CSS for horizontal scrolling:
       ```css
       .table-scroll-wrapper {
         overflow-x: auto;
         -webkit-overflow-scrolling: touch;
         position: relative;
       }
       ```

    4. Add CSS to freeze the first two columns (checkbox + variant ID):
       ```css
       /* Freeze first column (checkbox) */
       :deep(.v-data-table) th:first-child,
       :deep(.v-data-table) td:first-child {
         position: sticky;
         left: 0;
         z-index: 2;
         background: rgb(var(--v-theme-surface));
       }

       /* Freeze second column (variant ID) */
       :deep(.v-data-table) th:nth-child(2),
       :deep(.v-data-table) td:nth-child(2) {
         position: sticky;
         left: 48px; /* Width of checkbox column */
         z-index: 2;
         background: rgb(var(--v-theme-surface));
       }

       /* Add shadow to indicate scroll */
       :deep(.v-data-table) th:nth-child(2)::after,
       :deep(.v-data-table) td:nth-child(2)::after {
         content: '';
         position: absolute;
         top: 0;
         right: -8px;
         bottom: 0;
         width: 8px;
         background: linear-gradient(to right, rgba(0,0,0,0.1), transparent);
         pointer-events: none;
       }
       ```

    5. Ensure excluded-row styling still works with frozen columns by using CSS variables for background.

    6. Import useDisplay and use smAndDown to conditionally apply scroll wrapper only on mobile:
       - Add `import { useDisplay } from 'vuetify'`
       - Add `const { smAndDown } = useDisplay()`
       - Use v-if on wrapper to only apply on mobile, or always apply (simpler)

    For simplicity, always apply the scroll wrapper - it won't hurt desktop and keeps code simple.
  </action>
  <verify>
    - Open app on mobile viewport (375px width)
    - Navigate to results step with variants
    - Open variant modal
    - Table should scroll horizontally
    - Checkbox and Variant ID columns should stay visible while scrolling
    - Shadow indicator should appear when scrollable
    - Excluded row styling still works (dimmed appearance)
  </verify>
  <done>VariantTable has horizontal scroll with frozen first two columns (checkbox + ID) on all screen sizes</done>
</task>

<task type="auto">
  <name>Task 2: Add horizontal scroll to StepResults population table</name>
  <files>src/components/wizard/StepResults.vue</files>
  <action>
    Wrap the v-data-table (population results table) in a scrollable container:

    1. Locate the v-data-table showing population results (around line 146)
    2. Wrap it in a div with class "table-scroll-wrapper"
    3. Add scoped CSS:
       ```css
       .table-scroll-wrapper {
         overflow-x: auto;
         -webkit-overflow-scrolling: touch;
         position: relative;
         margin: 0 -16px; /* Extend to card edges on mobile */
         padding: 0 16px;
       }

       @media (min-width: 960px) {
         .table-scroll-wrapper {
           margin: 0;
           padding: 0;
         }
       }

       /* Freeze Population column */
       :deep(.v-data-table) th:first-child,
       :deep(.v-data-table) td:first-child {
         position: sticky;
         left: 0;
         z-index: 2;
         background: rgb(var(--v-theme-surface));
       }

       /* Shadow indicator */
       :deep(.v-data-table) th:first-child::after,
       :deep(.v-data-table) td:first-child::after {
         content: '';
         position: absolute;
         top: 0;
         right: -8px;
         bottom: 0;
         width: 8px;
         background: linear-gradient(to right, rgba(0,0,0,0.08), transparent);
         pointer-events: none;
       }
       ```

    4. The global row has special bg-grey-lighten-4 class - ensure frozen column inherits:
       ```css
       :deep(.bg-grey-lighten-4) td:first-child {
         background: rgb(var(--v-theme-grey-lighten-4, 245, 245, 245));
       }

       :deep(.bg-blue-lighten-5) td:first-child {
         background: rgb(var(--v-theme-blue-lighten-5, 227, 242, 253));
       }
       ```

    Note: Vuetify may not have CSS variables for these colors. Use hardcoded fallbacks:
    - grey-lighten-4: #f5f5f5
    - blue-lighten-5: #e3f2fd
  </action>
  <verify>
    - Open app on mobile viewport (375px width)
    - Complete wizard to results step
    - Population table should scroll horizontally
    - Population column stays visible while scrolling
    - Global row styling (bold, gray background) preserved
    - Founder effect rows (blue background) preserved
    - Row click to drill down still works
  </verify>
  <done>StepResults population table has horizontal scroll with frozen Population column</done>
</task>

</tasks>

<verification>
After completing all tasks:
1. Test VariantTable on mobile viewport - horizontal scroll works, first 2 columns frozen
2. Test StepResults table on mobile viewport - horizontal scroll works, Population frozen
3. All row interactions still work (click, expand, checkbox)
4. Row styling preserved (excluded dimming, global bold, founder effect highlight)
5. `bun run build` succeeds
6. `bun run lint` passes
</verification>

<success_criteria>
- MOB-03: Variant table is usable on small screens with horizontal scroll
- MOB-03: Results table is usable on small screens with horizontal scroll
- Frozen columns keep essential data visible while scrolling
- Visual scroll indicators present
- All existing functionality preserved
</success_criteria>

<output>
After completion, create `.planning/phases/14-mobile-optimization/14-02-SUMMARY.md`
</output>
