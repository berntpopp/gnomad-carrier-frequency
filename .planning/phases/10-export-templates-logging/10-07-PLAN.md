---
phase: 10-export-templates-logging
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - package.json
  - bun.lockb
  - vite.config.ts
autonomous: true

must_haves:
  truths:
    - "Build runs TypeScript and ESLint checks in parallel"
    - "Type errors appear in browser overlay during development"
    - "Lint errors appear in browser overlay during development"
    - "Build fails if type or lint errors exist"
  artifacts:
    - path: "vite.config.ts"
      provides: "vite-plugin-checker configuration"
      contains: "checker"
    - path: "package.json"
      provides: "vite-plugin-checker dependency"
      contains: "vite-plugin-checker"
  key_links:
    - from: "vite.config.ts"
      to: "vite-plugin-checker"
      via: "plugin import"
      pattern: "import checker from 'vite-plugin-checker'"
---

<objective>
Add vite-plugin-checker for parallel TypeScript and ESLint checking during development.

Purpose: Improve developer experience with faster feedback and overlay errors in browser.
Output: Configured vite-plugin-checker running vue-tsc and ESLint in parallel.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/10-export-templates-logging/10-RESEARCH.md

@vite.config.ts (integration target)
@package.json (add dependency)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Install vite-plugin-checker</name>
  <files>package.json, bun.lockb</files>
  <action>
Install vite-plugin-checker as dev dependency:

```bash
bun add -d vite-plugin-checker
```

This adds the checker plugin that runs TypeScript and ESLint in parallel during development.
  </action>
  <verify>vite-plugin-checker listed in package.json devDependencies</verify>
  <done>vite-plugin-checker installed as dev dependency</done>
</task>

<task type="auto">
  <name>Task 2: Configure vite-plugin-checker in vite.config.ts</name>
  <files>vite.config.ts</files>
  <action>
Update vite.config.ts to add checker plugin:

```typescript
import { defineConfig } from 'vite'
import vue from '@vitejs/plugin-vue'
import checker from 'vite-plugin-checker'
import { fileURLToPath, URL } from 'node:url'
import pkg from './package.json'

// https://vite.dev/config/
export default defineConfig({
  plugins: [
    vue(),
    checker({
      // Enable vue-tsc for TypeScript checking
      vueTsc: true,
      // Enable ESLint checking
      eslint: {
        lintCommand: 'eslint "./src/**/*.{ts,vue}"',
        useFlatConfig: true, // Use flat config format (eslint.config.js)
      },
      // Show overlay in browser for errors
      overlay: {
        initialIsOpen: false, // Don't auto-open, but show badge
        position: 'br', // Bottom-right
      },
    }),
  ],
  define: {
    'import.meta.env.VITE_APP_VERSION': JSON.stringify(pkg.version),
  },
  base: '/gnomad-carrier-frequency/',  // GitHub Pages subdirectory
  resolve: {
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))
    }
  },
  server: {
    // WSL2 with Windows filesystem requires polling for file watching
    // See: https://vite.dev/config/server-options.html#server-watch
    watch: {
      usePolling: true,
      interval: 100, // Polling interval in ms
    },
    // HMR configuration
    hmr: {
      overlay: true, // Show error overlay in browser
    },
    // Proxy for ClinGen API to avoid CORS issues in development
    proxy: {
      '/api/clingen': {
        target: 'https://search.clinicalgenome.org',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api\/clingen/, '/api'),
      },
    },
  },
})
```

Key configuration notes:
- vueTsc: true - runs vue-tsc in separate process
- eslint.lintCommand - runs ESLint with the specified command
- eslint.useFlatConfig: true - required for eslint.config.js flat config format
- overlay.initialIsOpen: false - shows badge but doesn't auto-open
- overlay.position: 'br' - bottom-right corner
  </action>
  <verify>`bun run dev` starts with checker running, errors appear in overlay</verify>
  <done>vite-plugin-checker configured with vue-tsc and ESLint</done>
</task>

<task type="auto">
  <name>Task 3: Verify parallel checking works</name>
  <files>(verification only)</files>
  <action>
Verify the configuration works correctly:

1. Run dev server:
```bash
bun run dev
```

2. Observe terminal output:
- Should show "vite-plugin-checker" starting both vue-tsc and eslint
- Both checkers run in parallel (not sequential)
- Output shows type/lint errors if any exist

3. Test overlay:
- Introduce a deliberate type error (e.g., add `const x: string = 123;` to a file)
- Browser should show error badge/overlay
- Fix the error - overlay should clear

4. Test build:
```bash
bun run build
```

- Build should fail if type or lint errors exist
- Build should succeed if no errors

5. Clean up any test errors introduced.

Note: If ESLint flat config detection fails, adjust the eslint.useFlatConfig setting or the lintCommand path as needed for the project's ESLint configuration.
  </action>
  <verify>Dev server shows checker output, overlay appears on errors, build enforces checks</verify>
  <done>Parallel checking verified working in development and build</done>
</task>

</tasks>

<verification>
1. `bun run dev` - starts with checker messages in terminal
2. Terminal shows both "vue-tsc" and "eslint" checker threads
3. Introduce type error - browser overlay shows error
4. Fix error - overlay clears
5. `bun run build` - fails on errors, succeeds when clean
6. `bun run lint` - still works independently (for CI)
7. `bun run typecheck` - still works independently (for CI)
</verification>

<success_criteria>
- INFRA-03: Build time improved with vite-plugin-checker (parallel checking)
- INFRA-04: Lint/typecheck runs in parallel
- Developer feedback loop faster (errors in overlay during dev)
- Build enforces both type and lint checks
</success_criteria>

<output>
After completion, create `.planning/phases/10-export-templates-logging/10-07-SUMMARY.md`
</output>
